@{
    ViewData["Title"] = "Messages Page";
    Layout = "_LayoutHome";
}
@using SocialNetwork.ViewModels
@model ChatSessionMessagesViewModel
<div class="container m-auto pt-5">

    <h1 class="font-semibold lg:mb-5 text-2xl"> Messages</h1>

    <div class="lg:flex lg:shadow lg:bg-white lg:space-y-0 space-y-8 rounded-md lg:-mx-0 -mx-5 overflow-hidden lg:dark:bg-gray-800">
        <!-- left message-->
        <div class="left-message lg:w-4/12 bg-white border-r overflow-hidden dark:bg-gray-800 dark:border-gray-600">

            <!-- search-->
            <div class="border-b px-4 py-4 dark:border-gray-600 search-left">
                <div class="bg-gray-100 input-with-icon rounded-md dark:bg-gray-700">
                    <input id="autocomplete-input" type="text" placeholder="Search" class="bg-transparent max-h-10 shadow-none">
                    <i style="font-size: 14px;" class="fa-solid fa-magnifying-glass"></i>
                </div>
            </div>

            <!-- user list-->
            <div class="pb-16 w-full scrollbar list-user scroll-style-1">
                <ul class="dark:text-gray-100">
                    @foreach (var item in Model.listChatSessiton){
                        <li> <a href="/Messages/Chatsession/@item.ChatId" class="block flex items-center py-3 px-4 space-x-3 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <div class="w-12 h-12 rounded-full relative flex-shrink-0">
                                    <img src="/assets/images/avatars/avatar-2.jpg" alt="" class="absolute h-full rounded-full w-full">
                                    <span class="absolute bg-green-500 border-2 border-white bottom-0 h-3 m-0.5 right-0 rounded-full shadow-md w-3"></span>
                                </div>
                                <div class="flex-1 min-w-0 relative text-gray-500">
                                    <h4 class="text-black font-semibold dark:text-white">@item.Name</h4>
                                    <span class="absolute right-0 top-1 text-xs">Sun</span>
                                    <p class="truncate">Esmod tincidunt ut laoreet</p>
                                </div>
                            </a>
                        </li>
                    }
                </ul>
            </div>
        </div>

        <!--  chatbox-->
        <div class="lg:w-8/12 bg-white dark:bg-gray-800">
            @if(Model.partner != null)
            {
                <div class="px-5 py-4 flex uk-flex-between header-chatbox">

                    <a href="#" class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-full relative flex-shrink-0">
                            <img src="/assets/images/avatars/avatar-1.jpg" alt="" class="h-full rounded-full w-full">
                            <span class="absolute bg-green-500 border-2 border-white bottom-0 h-3 m-0.5 right-0 rounded-full shadow-md w-3"></span>
                        </div>
                        <div class="flex-1 min-w-0 relative text-gray-500">
                            <h4 class="font-semibold text-black text-lg">@Model.partner.FullName</h4>

                            <p class="font-semibold leading-3 text-green-500 text-sm">is online</p>
                        </div>
                    </a>

                    <a href="/Messages/DeleteChatSession/@Model.chatID" class="flex hover:text-red-400 items-center leading-8 space-x-2 text-red-500 font-medium">
                        <i class="fa-solid fa-trash-can"></i> <span class="lg:block hidden"> Delete Conversation </span>
                    </a>
                </div>

                <div class="force-overflow scrollbar body-chatbox scroll-style-1">


                    <div class="border-t dark:border-gray-600">

                        <div class="lg:p-8 p-4 space-y-3">


                            <!-- my message-->
                            @foreach (var item in Model.listMessage)
                            {
                                @if (item.AccountId == CurrentAccount.account.AccountId)
                                {
                                    <h3 class="lg:w-60 mx-auto text-sm uk-heading-line uk-text-center lg:pt-2"><span> @item.CreateAt </span></h3>
                                    <div class="flex lg:items-center flex-row-reverse">
                                        <div class="w-14 h-14 rounded-full relative flex-shrink-0">
                                            <img src="/assets/images/avatars/avatar-2.jpg" alt="" class="absolute h-full rounded-full w-full">
                                        </div>
                                        <div class="text-white py-2 px-3 rounded bg-blue-600 relative h-full lg:mr-5 mr-2 lg:ml-20">
                                            <p class="leading-6">@item.MessageContent <i class="uil-grin-tongue-wink"></i> </p>
                                            <div class="absolute w-3 h-3 top-3 -right-1 bg-blue-600 transform rotate-45"></div>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <h3 class="lg:w-60 mx-auto text-sm uk-heading-line uk-text-center lg:pt-2"><span> @item.CreateAt </span></h3>
                                    <div class="flex lg:items-center">
                                        <div class="w-14 h-14 rounded-full relative flex-shrink-0">
                                            <img src="/assets/images/avatars/avatar-1.jpg" alt="" class="absolute h-full rounded-full w-full">
                                        </div>
                                        <div class="text-gray-700 py-2 px-3 rounded bg-gray-100 h-full relative lg:ml-5 ml-2 lg:mr-20 dark:bg-gray-700 dark:text-white">
                                            <p class="leading-6">@item.MessageContent <urna class="i uil-heart"></urna> <i class="uil-grin-tongue-wink"> </i> </p>
                                            <div class="absolute w-3 h-3 top-3 -left-1 bg-gray-100 transform rotate-45 dark:bg-gray-700"></div>
                                        </div>
                                    </div>
                                }
                            }

                        </div>


                    </div>
                </div>
                <form action="/messages/SendMessage" method="post">
                    <div class="border-t flex p-6 dark:border-gray-700 footer-chatbox">
                        <input name="chatId" type="text" value="@Model.chatID" hidden />
                        <input name="mess" cols="1" rows="1" placeholder="Your Message.." class="border-0 flex-1 h-10 min-h-0 resize-none min-w-0 shadow-none dark:bg-transparent"></input>
                        <div class="flex h-full space-x-2">
                            <button type="submit" class="bg-blue-600 font-semibold px-6 py-2 rounded-md text-white">Send</button>
                        </div>
                    </div>
                </form>
            }
            
        </div>
    </div>

</div>
